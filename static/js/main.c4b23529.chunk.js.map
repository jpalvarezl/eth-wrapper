{"version":3,"sources":["hooks/TxHook.ts","GlobalStyle.ts","components/EthBalance.tsx","utils/Erc20Constants.ts","components/WethBalance.tsx","components/Wrapper.tsx","App.tsx","index.tsx"],"names":["TxStatus","GlobalStyle","createGlobalStyle","avertaFont","avertaBoldFont","EthBalance","useState","balance","setBalance","useSafeAppsSDK","sdk","safe","a","eth","getBalance","safeAddress","balanceEth","ethers","utils","formatEther","useEffect","fetchBalance","console","log","Typography","variant","component","WETH_ADDRESS","Erc20","WethBalance","provider","useMemo","SafeAppsSdkProvider","weth","Contract","balanceOf","balanceWeth","Wrapper","amountToWrap","setAmountToWrap","errorMessage","setErrorMessage","availableEth","setAvailableEth","isError","setIsError","wrappingState","setWrappingState","submittedSafeTxHash","setSumittedSafeTxHash","setCopiedValue","wrapEth","useCallback","parsedAmount","parseEther","txs","send","to","value","toString","data","safeTx","safeTxHash","Executing","error","Number","parseFloat","fetchAvailableEth","validateAmout","newValue","isNaN","copySafeTxHash","document","execCommand","Snackbar","open","autoHideDuration","action","message","TextField","label","helperText","onChange","e","target","CardActions","Button","size","onClick","useStyles","styled","form","makeStyles","root","maxWidth","maxHeight","bullet","display","margin","transform","title","fontSize","pos","marginBottom","App","classes","Card","className","CardContent","ReactDOM","render","StrictMode","theme","loader","getElementById"],"mappings":"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","file":"static/js/main.c4b23529.chunk.js","sourcesContent":["import { useEffect, useState } from \"react\";\nimport SafeAppsSDK from '@gnosis.pm/safe-apps-sdk';\n\nexport enum TxStatus {\n    Executing,\n    Done\n}\n\nconst delay = (ms: number) => new Promise(resolve => setTimeout(resolve, ms))\n\nexport function TxHook(sdk: SafeAppsSDK, safeTxHash: string) {\n    const [isExecuting, setIsExecuting] = useState<TxStatus | null>(null)\n\n    useEffect(() => {\n        pollSafeTxHash()\n    })\n\n    async function pollSafeTxHash() {\n        while (true) {\n            const safeTx = await sdk.txs.getBySafeTxHash(safeTxHash);\n            console.log({ safeTx });\n            if (safeTx.isExecuted) {\n                setIsExecuting(TxStatus.Done);\n                return;\n            } else {\n                setIsExecuting(TxStatus.Executing);\n                await delay(5000);\n            }\n        }\n    }\n\n    return isExecuting;\n}\n","import { createGlobalStyle } from 'styled-components';\nimport avertaFont from '@gnosis.pm/safe-react-components/dist/fonts/averta-normal.woff2';\nimport avertaBoldFont from '@gnosis.pm/safe-react-components/dist/fonts/averta-bold.woff2';\n\nconst GlobalStyle = createGlobalStyle`\n    html {\n        height: 100%\n    }\n\n    body {\n       height: 100%;\n       margin: 0px;\n       padding: 0px;\n    }\n\n    #root {\n        height: 100%;\n        padding-right: 0.5rem;\n    }\n\n    .MuiFormControl-root,\n    .MuiInputBase-root {\n        width: 100% !important;\n    }\n\n    @font-face {\n        font-family: 'Averta';\n        src: local('Averta'), local('Averta Bold'),\n        url(${avertaFont}) format('woff2'),\n        url(${avertaBoldFont}) format('woff');\n    }\n`;\n\nexport default GlobalStyle;\n","import React, { useEffect, useState } from 'react';\nimport { ethers } from 'ethers';\nimport { useSafeAppsSDK } from '@gnosis.pm/safe-apps-react-sdk';\nimport { Typography } from '@material-ui/core';\n\nconst EthBalance: React.FC = () => {\n    const [balance, setBalance] = useState(\"loading state\");\n    const { sdk, safe } = useSafeAppsSDK();\n\n    async function fetchBalance() {\n        const balanceEth = await sdk.eth.getBalance([safe.safeAddress]);\n        setBalance(ethers.utils.formatEther(balanceEth));\n    }\n\n    useEffect(() => {\n        fetchBalance();\n        console.log(\"Updating ETH balance\");\n    }, []);\n\n    return <Typography variant=\"body2\" component=\"p\" >ETH balance: {balance}</Typography>\n}\n\nexport default EthBalance;\n\n","export const WETH_ADDRESS = \"0xc778417E063141139Fce010982780140Aa0cD5Ab\";\nexport const Erc20 = [\n    \"function approve(address _spender, uint256 _value) public returns (bool success)\",\n    \"function allowance(address _owner, address _spender) public view returns (uint256 remaining)\",\n    \"function balanceOf(address _owner) public view returns (uint256 balance)\",\n    \"event Approval(address indexed _owner, address indexed _spender, uint256 _value)\"\n];\n","import React, { useEffect, useState, useMemo, useCallback } from 'react';\nimport { Title } from '@gnosis.pm/safe-react-components';\nimport { SafeAppsSdkProvider } from '@gnosis.pm/safe-apps-ethers-provider';\nimport { ethers } from 'ethers';\nimport { useSafeAppsSDK } from '@gnosis.pm/safe-apps-react-sdk';\nimport { WETH_ADDRESS, Erc20 } from '../utils/Erc20Constants'\nimport { Typography } from '@material-ui/core';\n\nconst WethBalance: React.FC = () => {\n    const [balance, setBalance] = useState(\"\");\n\n    const { sdk, safe } = useSafeAppsSDK();\n    const provider = useMemo(() => new SafeAppsSdkProvider(safe, sdk), [safe, sdk]);\n    const weth = useMemo(() => new ethers.Contract(WETH_ADDRESS, Erc20, provider), [provider]);\n\n    async function fetchBalance() {\n        const balanceWeth = await weth.balanceOf(safe.safeAddress);\n        setBalance(ethers.utils.formatEther(balanceWeth));\n    }\n\n    useEffect(() => {\n        fetchBalance();\n        console.log(\"Updating WETH balance\");\n    }, []);\n\n    return <Typography variant=\"body2\" component=\"p\" >WETH Balance: {balance}</Typography>\n}\n\nexport default WethBalance;\n\n","import React, { useCallback, useEffect, useState } from 'react';\nimport { useSafeAppsSDK } from '@gnosis.pm/safe-apps-react-sdk';\nimport { Button, CardActions, Snackbar, TextField } from '@material-ui/core';\nimport { WETH_ADDRESS } from '../utils/Erc20Constants';\nimport { ethers } from 'ethers';\nimport { TxHook, TxStatus } from '../hooks/TxHook';\n\nconst Wrapper: React.FC = () => {\n    const { sdk, safe } = useSafeAppsSDK();\n    const [amountToWrap, setAmountToWrap] = useState(\"\");\n    const [errorMessage, setErrorMessage] = useState(\"\");\n    const [availableEth, setAvailableEth] = useState(0.0);\n    const [isError, setIsError] = useState(false);\n    const [wrappingState, setWrappingState] = useState<TxStatus | null>(null);\n    const [submittedSafeTxHash, setSumittedSafeTxHash] = useState<string | null>(null);\n    const [copiedValue, setCopiedValue] = useState(\"\");\n\n    const wrapEth = useCallback(async () => {\n        if (isError) {\n            return;\n        }\n        try {\n            const parsedAmount = ethers.utils.parseEther(amountToWrap)\n            const safeTx = await sdk.txs.send({\n                txs: [{\n                    to: WETH_ADDRESS,\n                    value: parsedAmount.toString(),\n                    data: '0x'\n                }]\n            })\n            // setWrappingState(TxHook(sdk, safeTx.safeTxHash));\n            setSumittedSafeTxHash(safeTx.safeTxHash);\n            setWrappingState(TxStatus.Executing);\n\n        } catch (e) {\n            console.error(e)\n        }\n    }, [sdk, amountToWrap, isError])\n\n    useEffect(() => {\n        fetchAvailableEth();\n    }, [safe, sdk]);\n\n    async function fetchAvailableEth() {\n        const balanceEth = await sdk.eth.getBalance([safe.safeAddress]);\n        const a = ethers.utils.formatEther(balanceEth);\n        setAvailableEth(Number.parseFloat(a));\n    };\n\n    const validateAmout = useCallback((newValue: string) => {\n        console.log(newValue);\n        if (isNaN(Number(newValue))) {\n            setIsError(true);\n            setErrorMessage(\"Not a number\");\n        }\n        else if (Number.parseFloat(newValue) > availableEth) {\n            setIsError(true);\n            setErrorMessage(\"Not enough Ether\");\n        }\n        else {\n            setIsError(false);\n            setErrorMessage(\"\");\n            setAmountToWrap(newValue);\n        }\n    }, [availableEth])\n\n    const copySafeTxHash = useCallback((value: string) => {\n        document.execCommand(\"copy\", false, value);\n        setCopiedValue(value);\n    }, [submittedSafeTxHash]);\n\n    return (\n        <div>\n            <Snackbar\n                open={wrappingState == TxStatus.Executing}\n                autoHideDuration={6000}\n                action={() => copySafeTxHash(submittedSafeTxHash!)}\n                message={\"Tap to copy your safeTxHash: \" + submittedSafeTxHash} />\n            <TextField\n                value={amountToWrap}\n                label=\"ETH amount\"\n                error={isError}\n                helperText={errorMessage}\n                onChange={e => validateAmout(e.target.value)} />\n\n            <CardActions>\n                <Button\n                    size=\"small\"\n                    onClick={() => wrapEth()}>\n                    Wrap ETH\n            </Button>\n            </CardActions>\n        </div>);\n}\n\nexport default Wrapper;\n","import styled from 'styled-components';\nimport EthBalance from './components/EthBalance';\nimport WethBalance from './components/WethBalance';\nimport Wrapper from './components/Wrapper';\nimport { CardContent, Card, makeStyles, CardActions } from '@material-ui/core';\n\nconst Container = styled.form`\n  margin-bottom: 2rem;\n  width: 100%;\n  max-width: 480px;\n\n  display: grid;\n  grid-template-columns: 1fr;\n  grid-column-gap: 1rem;\n  grid-row-gap: 1rem;\n`;\n\nconst useStyles = makeStyles({\n  root: {\n    maxWidth: \"300px\",\n    maxHeight: \"200px\"\n  },\n  bullet: {\n    display: 'inline-block',\n    margin: '0 2px',\n    transform: 'scale(0.8)',\n  },\n  title: {\n    fontSize: 14,\n  },\n  pos: {\n    marginBottom: 12,\n  },\n});\n\n\nconst App: React.FC = () => {\n  const classes = useStyles();\n\n  return (\n    <Card className={classes.root} >\n      <CardContent>\n        <EthBalance />\n        <WethBalance />\n      </CardContent>\n      <CardActions>\n        <Wrapper />\n      </CardActions>\n    </Card>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ThemeProvider } from 'styled-components';\nimport { theme, Loader, Title } from '@gnosis.pm/safe-react-components';\nimport SafeProvider from '@gnosis.pm/safe-apps-react-sdk';\n\nimport GlobalStyle from './GlobalStyle';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <ThemeProvider theme={theme}>\n      <GlobalStyle />\n      <SafeProvider\n        loader={\n          <>\n            <Title size=\"md\">Waiting for Safe...</Title>\n            <Loader size=\"md\" />\n          </>\n        }\n      >\n        <App />\n      </SafeProvider>\n    </ThemeProvider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}